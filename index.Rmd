---
title: "NYC"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Map practice TEST

Small test

You can also embed plots, for example:

```{r pressure, echo=FALSE, message=FALSE, warning=FALSE}
#install.packages(c("cowplot", "googleway", "ggplot2", "ggrepel", 
#"ggspatial", "libwgeom", "sf", "rnaturalearth", "rnaturalearthdata"))

library("ggplot2")
theme_set(theme_bw())
library("sf")

library("rnaturalearth")
library("rnaturalearthdata")

world <- ne_countries(scale = "medium", returnclass = "sf")
class(world)
```

```{r, echo=FALSE}
ggplot(data = world) +
    geom_sf()

ggplot(data = world) +
    geom_sf() +
    xlab("Longitude") + ylab("Latitude") +
    ggtitle("World map", subtitle = paste0("(", length(unique(world$NAME)), " countries)"))

ggplot(data = world) + 
    geom_sf(color = "black", fill = "lightgreen")

ggplot(data = world) +
    geom_sf(aes(fill = pop_est)) +
    scale_fill_viridis_c(option = "plasma", trans = "sqrt")


sites <- data.frame(longitude = c(-80.144005, -80.109), latitude = c(26.479005, 
    26.83))
ggplot(data = world) +
    geom_sf() +
    geom_point(data = sites, aes(x = longitude, y = latitude), size = 4, 
        shape = 23, fill = "darkred") +
    coord_sf(xlim = c(-87, -50), ylim = c(24.5, 33), expand = FALSE)
```

#Plot out NYC
```{r}
library(ggplot2)
library(ggmap)
```

```{r}
nyc.map <- get_map(location = "New York City", zoom = 10, maptype = "roadmap")
nyc.map <- ggmap(nyc.map)
```

different types of map available: “terrain”, “satellite”, “roadmap”, “hybrid”

# import the latitude data

```{r}
library(tidyverse)
X2019_2020_School_Point_Locations <- read_csv("raw/2019_-_2020_School_Point_Locations.csv")

### using the first column to identify school locations 
head(X2019_2020_School_Point_Locations)
```
```{r}
#filter out schools with GT option
merged <- read_csv("raw/merged.csv")
merged_gf <- merged %>% filter(gifted == 1)
head(merged)
```

```{r}
library(dplyr)

gf_combined <- na.omit(X2019_2020_School_Point_Locations %>% 
                         left_join(merged_gf, by = c("Loc_Name"= "School Name")) %>%
                         select(c("the_geom","Loc_Name","DBN")))

head(gf_combined)
```
```{r}
v=c()
worddetect <- function(x){
  for (i in 1:length(x)){
    v = append(v,strsplit(x[i],"")[[1]][3])
  }
  v
}

a = worddetect(gf_combined$DBN)
gf_combined$Borough <- a
head(gf_combined)
```



```{r}
x <- str_extract(gf_combined$the_geom,"(?<=\\().*(?=\\))")
x <- unlist(strsplit(x," "))
```

```{r}
odd <- seq(1,201,2)
even <- seq(2,202,2)
long <- c()
lat <- c()

for (i in 1:101){
  long[i] <- x[odd[i]]
  lat[i] <- x[even[i]]
}
gf_combined$long <- as.numeric(long)
gf_combined$lat <- as.numeric(lat)
gf_combined

```
```{r}
nyc.map+geom_point(aes(x=long,y=lat,colour = Borough),data = gf_combined,size=0.7)
```



